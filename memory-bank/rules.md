# 地图对话网站编程规则文档

## 一、代码结构规则
### （一）前端代码结构
1. **项目根目录**：包含 `index.html` 作为入口文件，以及 `src` 目录用于存放源代码。
2. **`src` 目录**：
    - **`components` 子目录**：存放 Vue 组件，如聊天框组件 `ChatBox.vue`、地图显示组件 `MapDisplay.vue` 等。每个组件应具有独立的功能和样式，组件内部的代码应按照模板、脚本、样式的顺序排列。
    - **`assets` 子目录**：存放静态资源，如图标、图片等。
    - **`router` 子目录**：存放路由配置文件 `index.js`，用于管理页面路由。
    - **`store` 子目录**：如果使用 Vuex 进行状态管理，该目录存放相关配置文件。
3. **`public` 目录**：存放公共资源，如 `favicon.ico` 等。

### （二）后端代码结构
1. **项目根目录**：包含 `app.py` 作为 Flask 应用的入口文件，以及 `config.py` 用于存放配置信息。
2. **`api` 目录**：存放 API 接口相关的代码，每个接口可以对应一个 Python 文件，如 `map_query.py` 用于处理地图查询相关的接口。
3. **`models` 目录**：存放数据库模型相关的代码，如 `user_history.py` 用于定义用户历史查询记录的数据库模型。
4. **`utils` 目录**：存放工具函数相关的代码，如 `amap_utils.py` 用于封装高德地图工具的调用。

## 二、命名规范规则
### （一）前端命名规范
1. **组件命名**：采用大驼峰命名法，如 `ChatBox.vue`、`MapDisplay.vue`。
2. **变量命名**：采用小驼峰命名法，如 `userInput`、`searchResult`。
3. **CSS 类名**：采用短横线分隔命名法，如 `.chat-box`、`.map-display`。

### （二）后端命名规范
1. **函数命名**：采用小写字母加下划线的命名法，如 `parse_user_input`、`query_around_places`。
2. **变量命名**：同样采用小写字母加下划线的命名法，如 `user_request`、`search_keyword`。
3. **数据库表名**：采用小写字母加下划线的命名法，如 `user_history`、`common_places`。

## 三、接口调用规则
### （一）前端调用后端接口
1. 使用 Axios 进行 HTTP 请求，在组件中引入 Axios 并封装请求方法。
2. 请求方法应遵循 RESTful 规范，如 `GET` 用于获取数据，`POST` 用于提交数据。
3. 对请求结果进行统一的错误处理，显示友好的错误提示信息。

### （二）后端调用高德地图工具
1. 在 `utils/amap_utils.py` 中封装高德地图工具的调用方法，如 `get_location_by_address` 用于调用 `maps_geo` 工具。
2. 对工具调用结果进行错误处理，记录日志并返回合适的错误信息给前端。

## 四、数据库操作规则
### （一）数据库连接
1. 在 `config.py` 中配置数据库连接信息，如数据库地址、用户名、密码等。
2. 在 `app.py` 中初始化数据库连接，使用 SQLAlchemy 进行数据库操作。

### （二）数据插入
1. 在插入用户历史查询记录时，确保数据的完整性和准确性，包括用户 ID、查询时间、查询关键词等信息。
2. 使用事务处理确保数据插入的原子性。

### （三）数据查询
1. 在查询用户历史查询记录时，根据用户 ID 进行筛选，支持分页查询。
2. 对查询结果进行排序，如按照查询时间降序排列。

## 五、代码注释规则
### （一）前端代码注释
1. 在组件的开头添加注释，说明组件的功能和使用方法。
2. 在关键代码段添加注释，解释代码的逻辑和作用。

### （二）后端代码注释
1. 在函数的开头添加注释，说明函数的功能、参数和返回值。
2. 在复杂的代码逻辑处添加注释，帮助其他开发者理解代码。

## 六、版本控制规则
1. 使用 Git 进行版本控制，创建不同的分支进行开发、测试和生产。
2. 每次提交代码时，添加详细的提交信息，说明本次提交的内容和目的。
3. 定期进行代码合并和拉取操作，保持代码库的同步。